/**
 * Minified by jsDelivr using Terser v5.13.1.
 * Original file: /gh/mudcube/MIDI.js@master/js/midi/plugin.webaudio.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(n){"use strict";var e,t,o,i,a,r;window.AudioContext&&(t=n.WebAudio={api:"webaudio"},o={},i={},a=127,r={},t.audioBuffers=r,t.send=function(n,e){},t.setController=function(n,e,t,o){},t.setVolume=function(n,e,t){t?setTimeout((function(){a=e}),1e3*t):a=e},t.programChange=function(e,t,o){n.channels[e].instrument=t},t.pitchBend=function(e,t,o){n.channels[e].pitchBend=t},t.noteOn=function(t,u,f,c){c=c||0;var s=n.channels[t].instrument,d=r[s+""+u];if(d){var l;if(c<e.currentTime&&(c+=e.currentTime),(l=e.createBufferSource()).buffer=d,i){var v=l;for(var m in i)v.connect(i[m].input),v=i[m]}var p=f/127*(a/127)*2-1;return l.connect(e.destination),l.playbackRate.value=1,l.gainNode=e.createGain(),l.gainNode.connect(e.destination),l.gainNode.gain.value=Math.min(1,Math.max(-1,p)),l.connect(l.gainNode),l.start(c||0),o[t+""+u]=l,l}},t.noteOff=function(t,i,a){a=a||0;var u=n.channels[t].instrument,f=r[u+""+i];if(f){a<e.currentTime&&(a+=e.currentTime);var c=o[t+""+i];if(c){if(c.gainNode){var s=c.gainNode.gain;s.linearRampToValueAtTime(s.value,a),s.linearRampToValueAtTime(-1,a+.3)}return c.noteOff?c.noteOff(a+.5):c.stop(a+.5),delete o[t+""+i],c}}},t.chordOn=function(n,e,o,i){for(var a,r={},u=0,f=e.length;u<f;u++)r[a=e[u]]=t.noteOn(n,a,o,i);return r},t.chordOff=function(n,e,o){for(var i,a={},r=0,u=e.length;r<u;r++)a[i=e[r]]=t.noteOff(n,i,o);return a},t.stopAllNotes=function(){for(var n in o){var t=0;t<e.currentTime&&(t+=e.currentTime);var i=o[n];i.gain.linearRampToValueAtTime(1,t),i.gain.linearRampToValueAtTime(0,t+.3),i.noteOff?i.noteOff(t+.3):i.stop(t+.3),delete o[n]}},t.setEffects=function(n){if(!e.tunajs)return console.log("Effects module not installed.");for(var t=0;t<n.length;t++){var o=n[t],a=new e.tunajs[o.type](o);a.connect(e.destination),i[o.type]=a}},t.connect=function(o){n.setDefaultPlugin(t),t.setContext(e||new(window.AudioContext||window.webkitAudioContext),o.onsuccess)},t.getContext=function(){return e},t.setContext=function(t,o,i,a){e=t,"undefined"==typeof Tuna||e.tunajs||(e.tunajs=new Tuna(e));var u=[],f=n.keyToNote;for(var c in f)u.push(c);var s=function(n){for(var e in l)if(l[e])return;o&&(o(),o=null)},d=function(t,o,i,a){var u=t[a];u&&(l[o]++,function(n,t,o){if(0===n.indexOf("data:audio")){var i=n.split(",")[1],a=Base64Binary.decodeArrayBuffer(i);e.decodeAudioData(a,t,o)}else{var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="arraybuffer",r.onload=function(){e.decodeAudioData(r.response,t,o)},r.send()}}(u,(function(e){e.id=a;var i=n.keyToNote[a];r[o+""+i]=e,0==--l[o]&&(t.isLoaded=!0,s())}),(function(n){})))},l={};for(var v in n.Soundfont){var m=n.Soundfont[v];if(!m.isLoaded){var p=n.GM.byName[v].number;l[p]=0;for(var T=0;T<u.length;T++)d(m,p,0,c=u[T])}}setTimeout(s,1)})}(MIDI);
//# sourceMappingURL=/sm/94d2246632bd22d5180d343151a8321f329744c91b0d86f2b1a127aed4af3ba4.map